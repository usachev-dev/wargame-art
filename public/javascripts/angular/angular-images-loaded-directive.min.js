/**
    @name: angular-images-loaded-jtt 
    @version: 1.0.0 (11-01-2016) 
    @author: Jonathan Hornung <jonathan.hornung@gmail.com> 
    @url: https://github.com/JohnnyTheTank/angular-images-loaded-custom#readme 
    @license: MIT
*/
!function(){"use strict";angular.module("jtt_imagesLoaded",[]).directive("imagesLoaded",["$timeout","$rootScope","$q",function(a,b,c){function d(b){a(b,0)}function e(a,b,c){this.loaded=void 0,this.loading=!0,c?this.__onload(b,!0):(this.node=new Image,this.bind(b),this.node.src=a)}function f(a){this.imagesCount=0,this.imagesLoaded=0,this.imagesFailed=0,this.useProgressEvents=a}var g={},h={progress:["imagesLoaded.QUARTER","imagesLoaded.HALF","imagesLoaded.THREEQUARTERS","imagesLoaded.FULL"],successful:"imagesLoaded.SUCCESS",complete:"imagesLoaded.FAIL",always:"imagesLoaded.ALWAYS"};return e.prototype={constructor:e,bind:function(a){var b=this;this.node.addEventListener("load",function(){b.__onload(a,!0)},!1),this.node.addEventListener("error",function(){b.__onload(a,!1)},!1)},__onload:function(a,b){this.loaded=!0,this.loading=!1,b&&this.node&&delete this.node,a(b)}},f.prototype={constructor:f,whenImagesLoaded:function(a){function b(a){var b;a?l.imagesLoaded++:l.imagesFailed++,l.useProgressEvents&&(b=(l.imagesLoaded+l.imagesFailed)/Math.ceil(k/4))&&b%1===0&&4>b&&d(function(){j.notify(h.progress[b-1])}),l.imagesLoaded+l.imagesFailed===l.imagesCount&&d(function(){j.notify(h.progress[3]),j.resolve(l.imagesFailed>0?h.complete:h.success)})}function f(a){var c=a.src,d=g[c];d?d.loaded?b(!0):d.loading?d.bind(b):d.loaded===!1:a.complete&&a.naturalWidth>0?g[c]=new e(c,b,!0):g[c]=new e(c,b)}var i,j=c.defer(),k=a.length,l=this;this.imagesCount=k;for(var m=0;m<this.imagesCount;m++)i=a[m],f(i);return j.promise}},{restrict:"A",compile:function(a,b){return function(a,b,c){var e,g=(b[0].childNodes,"yes"===c.useProgressEvents),i=0,j=document.images;a.$watch(function(){return j.length},function(c,j){var k,l;c!==j&&(e=b.find("img"),k=e.length,k!==i&&(i=k,l=new f(g),d(function(){l.whenImagesLoaded(e).then(function(b){a.$emit(b),a.$emit(h.always)},function(a){},function(b){g&&a.$emit("imagesLoaded.PROGRESS",{status:b})})})))})}}}}])}();